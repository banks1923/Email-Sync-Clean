graph TD
    subgraph "Core Database Layer"
        SimpleDB[shared/simple_db.py<br/>ğŸ“Š 47 methods<br/>ğŸ”„ WAL mode, 64MB cache]
        ContentUnified[(content_unified table<br/>645 records)]
        IndividualMessages[(individual_messages<br/>Message deduplication)]
    end
    
    subgraph "Primary Services"
        Gmail[gmail/<br/>ğŸ“§ Email sync<br/>OAuth integration]
        PDF[pdf/<br/>ğŸ“„ OCR + processing<br/>Enhanced pipeline]
        Entity[entity/<br/>ğŸ·ï¸ NER extraction<br/>Legal BERT]
        Summarization[summarization/<br/>ğŸ“ TF-IDF + TextRank]
        SearchIntel[search_intelligence/<br/>ğŸ” Hybrid search]
        LegalIntel[legal_intelligence/<br/>âš–ï¸ Legal analysis]
    end
    
    subgraph "Utilities Layer"
        Embeddings[utilities/embeddings/<br/>ğŸ¤– Legal BERT service<br/>1024D vectors]
        VectorStore[utilities/vector_store/<br/>ğŸ“¡ Qdrant integration]
        Timeline[utilities/timeline/<br/>ğŸ“… Event sequencing]
        SemanticPipeline[utilities/semantic_pipeline.py<br/>ğŸ”„ Orchestration hub]
    end
    
    subgraph "Infrastructure"
        MCPServers[infrastructure/mcp_servers/<br/>ğŸ”Œ Claude integration<br/>12+ tools]
        Documents[infrastructure/documents/<br/>ğŸ“‹ Document management]
        Pipelines[infrastructure/pipelines/<br/>ğŸ¯ Service coordination]
    end
    
    subgraph "Email Processing v2.0"
        EmailParser[email_parsing/<br/>ğŸ†• Message deduplicator<br/>97% test coverage]
        MessageBoundary[Boundary detection<br/>Reply/forward parsing]
        ContentHashing[SHA256 hashing<br/>Duplicate prevention]
    end
    
    subgraph "External Services"
        Qdrant[(Qdrant<br/>localhost:6333<br/>Vector database)]
        QdrantClient[Qdrant HTTP API<br/>Health checks]
    end
    
    subgraph "Tools & CLI"
        VSearchCLI[tools/scripts/vsearch<br/>ğŸ› ï¸ Main user interface]
        HealthDashboard[scripts/system_health_graph.py<br/>ğŸ“Š Monitoring]
        LiveDashboard[scripts/live_health_dashboard.py<br/>ğŸ“ˆ Real-time monitoring]
    end
    
    %% Database Dependencies (High Priority)
    SimpleDB --> ContentUnified
    SimpleDB --> IndividualMessages
    
    Gmail --> SimpleDB
    PDF --> SimpleDB
    Entity --> SimpleDB
    Summarization --> SimpleDB
    SearchIntel --> SimpleDB
    LegalIntel --> SimpleDB
    
    %% Email Processing Dependencies
    EmailParser --> SimpleDB
    EmailParser --> ContentUnified
    EmailParser --> IndividualMessages
    MessageBoundary --> EmailParser
    ContentHashing --> EmailParser
    
    %% Utility Dependencies
    Embeddings --> SimpleDB
    VectorStore --> Qdrant
    VectorStore --> QdrantClient
    Timeline --> SimpleDB
    SemanticPipeline --> SimpleDB
    SemanticPipeline --> Embeddings
    SemanticPipeline --> VectorStore
    
    %% Service Interactions
    Entity --> Embeddings
    SearchIntel --> VectorStore
    SearchIntel --> Embeddings
    LegalIntel --> Entity
    LegalIntel --> Timeline
    
    %% Infrastructure Dependencies
    MCPServers --> SearchIntel
    MCPServers --> LegalIntel
    Documents --> PDF
    Pipelines --> SemanticPipeline
    
    %% Tool Dependencies
    VSearchCLI --> SearchIntel
    VSearchCLI --> LegalIntel
    VSearchCLI --> VectorStore
    HealthDashboard --> SimpleDB
    HealthDashboard --> QdrantClient
    LiveDashboard --> SimpleDB
    LiveDashboard --> QdrantClient
    
    %% Critical Path Highlighting
    style SimpleDB fill:#ff6b6b,stroke:#333,stroke-width:4px
    style ContentUnified fill:#ffd700,stroke:#333,stroke-width:3px
    style EmailParser fill:#87ceeb,stroke:#333,stroke-width:3px
    style SemanticPipeline fill:#90ee90,stroke:#333,stroke-width:2px
    style MCPServers fill:#ff7f50,stroke:#333,stroke-width:2px
    style Qdrant fill:#9370db,stroke:#fff,stroke-width:2px