graph LR
    subgraph "Data Layer"
        SimpleDB["SimpleDB<br/>content_unified table<br/>16 direct references"]
    end
    
    subgraph "Service Layer (35 files use SimpleDB)"
        Gmail[Gmail Service]
        PDF[PDF Service]
        Entity[Entity Service]
        Timeline[Timeline Service]
    end
    
    subgraph "Intelligence Modules"
        KG_Main[Knowledge Graph Main]
        KG_Sim[Similarity Analyzer]
        KG_Topic[Topic Clustering]
        KG_Timeline[Timeline Relations]
        
        SI_Main[Search Intelligence]
        SI_Dup[Duplicate Detector]
        SI_Sim[Similarity Service]
        
        LI_Main[Legal Intelligence]
    end
    
    subgraph "Utilities"
        Embeddings[Embedding Service<br/>Legal BERT]
        VectorStore[Vector Store<br/>Qdrant]
        SemanticPipe[Semantic Pipeline]
        VectorMaint[Vector Maintenance]
    end
    
    subgraph "CLI & Tools"
        InfoHandler[Info Handler]
        SearchHandler[Search Handler]
        ProcessEmbed[Process Embeddings]
        SyncVector[Sync Vector Store]
    end
    
    %% Data Layer Connections
    SimpleDB --> Gmail
    SimpleDB --> PDF
    SimpleDB --> Entity
    SimpleDB --> Timeline
    
    %% Intelligence Dependencies
    SimpleDB --> KG_Main
    SimpleDB --> KG_Sim
    SimpleDB --> KG_Topic
    SimpleDB --> KG_Timeline
    
    SimpleDB --> SI_Main
    SimpleDB --> SI_Dup
    SimpleDB --> SI_Sim
    
    SimpleDB --> LI_Main
    
    %% Utility Dependencies
    SimpleDB --> SemanticPipe
    SimpleDB --> VectorMaint
    
    %% CLI Dependencies
    SimpleDB --> InfoHandler
    SimpleDB --> ProcessEmbed
    SimpleDB --> SyncVector
    
    %% Cross-module Dependencies
    KG_Sim --> Embeddings
    KG_Topic --> Embeddings
    KG_Topic --> Entity
    
    SI_Sim --> Embeddings
    SI_Dup --> Embeddings
    
    SemanticPipe --> Embeddings
    SemanticPipe --> VectorStore
    SemanticPipe --> Entity
    
    ProcessEmbed --> Embeddings
    ProcessEmbed --> VectorStore
    
    VectorMaint --> VectorStore
    SyncVector --> VectorStore
    
    style SimpleDB fill:#ffd700,stroke:#333,stroke-width:4px
    style Embeddings fill:#ccffcc
    style VectorStore fill:#ccffcc